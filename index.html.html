<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Checklist Diario PRESTO</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f5f5f5;margin:0;padding:0}
.container{max-width:1000px;margin:0 auto;background:#fff;padding:18px 20px 40px;border-radius:14px}
h1{text-align:center;margin-bottom:4px}
small{display:block;text-align:center;margin-bottom:16px;color:#666}
.section{border:1px solid #e1e1e1;border-radius:12px;padding:14px 14px 4px;margin:14px 0}
.section h3{margin:0 0 10px}
label{display:block;margin:6px 0}
hr{margin:18px 0;border:none;border-top:1px dashed #ddd}
button{padding:12px 20px;border:0;border-radius:10px;background:#0d6efd;color:#fff;font-size:15px;cursor:pointer}
.checkgrid{display:grid;grid-template-columns:1fr 1fr;gap:6px 14px}
textarea{width:100%;min-height:80px}
input[type="text"],input[type="date"],input[type="time"]{padding:6px 8px;width:240px}
</style>
</head>
<body>
<div class="container">

<h1>CHECKLIST DIARIO DE CALIDAD E INOCUIDAD</h1>
<small>UNIDADES MÓVILES DE TRANSPORTE – PRESTO</small>

<form name="checklist" method="POST" data-netlify="true" id="formChecklist">
<input type="hidden" name="form-name" value="checklist" />

<div class="section">
<h3>Responsable del llenado</h3>
<label>Nombre del chofer: <input name="chofer" required></label>
</div>

<div class="section">
<h3>1. IDENTIFICACIÓN</h3>
<label>Fecha: <input type="date" name="fecha" required></label>
<label>Hora: <input type="time" name="hora" required></label>
<label>Placa de la unidad: <input name="placa" required></label>
<label>Ruta (Planta / Tienda): <input name="ruta" required></label>
<label>Firma (escriba nombre): <input name="firma"></label>
</div>

<div class="section">
<h3>2. REVISIÓN ANTES DE LA CARGA (PLANTA)</h3>
<strong>A. Sistema de Refrigeración y Cadena de Frío</strong>
<div class="checkgrid">
<label><input type="checkbox" name="a1"> Sistema de refrigeración operativo</label>
<label><input type="checkbox" name="a2"> Termómetro limpio</label>
<label><input type="checkbox" name="a3"> Sin goteos / escarcha</label>
<label><input type="checkbox" name="a4"> Cortinas térmicas íntegras</label>
</div>

<strong>B. Condiciones del Vehículo (Interior)</strong>
<div class="checkgrid">
<label><input type="checkbox" name="b1"> Limpio y en buen estado</label>
<label><input type="checkbox" name="b2"> Sin olores extraños</label>
<label><input type="checkbox" name="b3"> Sin cuerpos extraños</label>
<label><input type="checkbox" name="b4"> Sin plagas o indicios</label>
</div>

<strong>C. Equipos y Utensilios</strong>
<div class="checkgrid">
<label><input type="checkbox" name="c1"> Jabas y contenedores limpios</label>
<label><input type="checkbox" name="c2"> Carros sin óxido</label>
<label><input type="checkbox" name="c3"> Productos no tocan el piso</label>
</div>
</div>

<div class="section">
<h3>3. CARGA DE PRODUCTOS</h3>
<div class="checkgrid">
<label><input type="checkbox" name="d1"> Íntegros y rotulados</label>
<label><input type="checkbox" name="d2"> Estiba ordenada</label>
<label><input type="checkbox" name="d3"> Separación adecuada</label>
<label><input type="checkbox" name="d4"> Puertas cerradas</label>
<label><input type="checkbox" name="d5"> Frío encendido</label>
</div>
</div>

<div class="section">
<h3>4. DURANTE EL TRANSPORTE</h3>
<div class="checkgrid">
<label><input type="checkbox" name="e1"> Refrigeración permanente</label>
<label><input type="checkbox" name="e2"> Temperatura 0–6 °C</label>
<label><input type="checkbox" name="e3"> No abrir innecesariamente</label>
<label><input type="checkbox" name="e4"> No objetos ajenos</label>
<label><input type="checkbox" name="e5"> No consumo dentro</label>
</div>
</div>

<div class="section">
<h3>5. DESCARGA EN TIENDA</h3>
<div class="checkgrid">
<label><input type="checkbox" name="f1"> Temp. ≤ 6 °C al llegar</label>
<label><input type="checkbox" name="f2"> Productos íntegros</label>
<label><input type="checkbox" name="f3"> Descarga rápida</label>
<label><input type="checkbox" name="f4"> Uso correcto jabas</label>
<label><input type="checkbox" name="f5"> Zona limpia</label>
<label><input type="checkbox" name="f6"> Retorno ordenado</label>
</div>
</div>

<div class="section">
<h3>6. HIGIENE Y PRESENTACIÓN DEL CHOFER</h3>
<div class="checkgrid">
<label><input type="checkbox" name="g1"> Uniforme limpio</label>
<label><input type="checkbox" name="g2"> Manos limpias</label>
<label><input type="checkbox" name="g3"> Uso de EPP</label>
<label><input type="checkbox" name="g4"> Sin joyas ni objetos</label>
<label><input type="checkbox" name="g5"> Sin heridas expuestas</label>
</div>
</div>

<div class="section">
<h3>7. ACCIONES ANTE DESVIACIONES</h3>
<div class="checkgrid">
<label><input type="checkbox" name="h1"> Reporte desviaciones temp.</label>
<label><input type="checkbox" name="h2"> Reporte incumplimientos</label>
<label><input type="checkbox" name="h3"> No continuar si hay riesgo</label>
<label><input type="checkbox" name="h4"> Informé a logística/calidad</label>
</div>
<label>Observaciones:
<textarea name="observaciones"></textarea></label>
</div>

<div class="section">
<h3>8. CIERRE DE JORNADA</h3>
<div class="checkgrid">
<label><input type="checkbox" name="i1"> Unidad descargada</label>
<label><input type="checkbox" name="i2"> Limpieza realizada</label>
<label><input type="checkbox" name="i3"> Registros completos</label>
<label><input type="checkbox" name="i4"> Unidad lista</label>
</div>
<label>Firma del chofer: <input name="firma_final"></label>
</div>

<hr>
<button type="submit">Enviar checklist</button>

<p id="msg" style="margin-top:10px;"></p>
</form>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const msg = document.getElementById('msg');
const form = document.getElementById('formChecklist');

form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  msg.innerText = 'Generando PDF y enviando...';

  // generar PDF básico
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.text('Checklist Diario PRESTO', 10, 10);
  doc.text('Chofer: ' + (form.chofer.value||''), 10, 18);
  doc.text('Fecha: ' + (form.fecha.value||''), 10, 26);
  const pdfBlob = doc.output('blob');

  // Crear formData para Netlify (envío por correo configurable desde panel)
  const data = new FormData(form);
  data.append('archivo_pdf', pdfBlob, 'checklist.pdf');

  fetch('/', { method:'POST', body:data })
    .then(()=>{
      msg.innerText = 'Enviado correctamente.';
      form.reset();
    })
    .catch(()=> msg.innerText='Ocurrió un error.');
});
</script>

</body>
</html>